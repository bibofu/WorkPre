## 事务



## 索引

mysql对索引的是用是由mysql的server层的优化器决定的

### Mysql各种索引区别：

普通索引：最基本的索引，没有任何限制

唯一索引：与"普通索引"类似，不同的就是：索引列的值必须唯一，但允许有空值。

主键索引：它 是一种特殊的唯一索引，不允许有空值。

全文索引：仅可用于 MyISAM 表，针对较大的数据，生成全文索引很耗时好空间。

组合索引：为了更多的提高mysql效率可建立组合索引，遵循”最左前缀“原则。


### 普通索引和唯一索引

**查询过程**

![](https://pic.imgdb.cn/item/6222128b5baa1a80aba5bacc.png)

ID为主键索引，k为普通索引

假设，执行查询的语句是 select id from T where k=5。

这个查询语句在索引树上查找的过程，先是通过 B+ 树从树根开始，按层搜索到叶子节点，也就是图中右下角的这个数据页，然后可以认为数据页内部通过二分法来定位记录。对于普通索引来说，查找到满足条件的第一个记录 (5,500) 后，需要查找下一个记录，直到碰到第一个不满足 k=5 条件的记录。对于唯一索引来说，由于索引定义了唯一性，查找到第一个满足条件的记录后，就会停止继续检索。

那么，这个不同带来的性能差距会有多少呢？答案是，微乎其微。



普通索引和唯一索引的查询性能几乎一样, 但是写性能是普通索引快, 因为可以用到change buffer



### MySQL WAL

Write-Ahead Logging

MySQL 里经常说到的 WAL技术，也就是先写日志，再写磁盘。

**当内存数据页跟磁盘数据页内容不一致的时候，我们成这个内存页为“脏页”。内存数据写入磁盘后，内存和磁盘上的数据页内容就一致了，称为“干净页”。**



### change-buffer和redo log

change buffer记录的只是针对不在内存中的数据，redo log不管数据在不在内存中，都记录。







## 锁